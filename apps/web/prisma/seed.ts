import { PrismaClient } from '@prisma/client'

const prisma = new PrismaClient()

async function main() {
  console.log('üå± Starting database seeding...')

  // Seed Vietnam provinces, districts, and wards
  await seedVietnamAddresses()
  
  // Seed products
  await seedProducts()
  
  // Seed suppliers
  await seedSuppliers()
  
  // Seed users
  await seedUsers()
  
  // Seed orders
  await seedOrders()

  console.log('‚úÖ Database seeding completed!')
}

async function seedVietnamAddresses() {
  console.log('üìç Seeding Vietnam addresses...')

  // Major provinces in Vietnam
  const provinces = [
    { code: '01', name: 'Th√†nh ph·ªë H√† N·ªôi', type: 'Th√†nh ph·ªë Trung ∆∞∆°ng' },
    { code: '79', name: 'Th√†nh ph·ªë H·ªì Ch√≠ Minh', type: 'Th√†nh ph·ªë Trung ∆∞∆°ng' },
    { code: '48', name: 'Th√†nh ph·ªë ƒê√† N·∫µng', type: 'Th√†nh ph·ªë Trung ∆∞∆°ng' },
    { code: '92', name: 'Th√†nh ph·ªë C·∫ßn Th∆°', type: 'Th√†nh ph·ªë Trung ∆∞∆°ng' },
    { code: '31', name: 'Th√†nh ph·ªë H·∫£i Ph√≤ng', type: 'Th√†nh ph·ªë Trung ∆∞∆°ng' },
    { code: '56', name: 'T·ªânh Kh√°nh H√≤a', type: 'T·ªânh' },
    { code: '77', name: 'T·ªânh B√† R·ªãa - V≈©ng T√†u', type: 'T·ªânh' },
    { code: '75', name: 'T·ªânh ƒê·ªìng Nai', type: 'T·ªânh' },
    { code: '89', name: 'T·ªânh An Giang', type: 'T·ªânh' },
    { code: '87', name: 'T·ªânh Ki√™n Giang', type: 'T·ªânh' }
  ]

  for (const provinceData of provinces) {
    const province = await prisma.province.upsert({
      where: { code: provinceData.code },
      update: {},
      create: provinceData
    })

    // Create some districts for each province
    const districts = [
      { code: `${provinceData.code}01`, name: `Qu·∫≠n 1`, type: 'Qu·∫≠n' },
      { code: `${provinceData.code}02`, name: `Qu·∫≠n 2`, type: 'Qu·∫≠n' },
      { code: `${provinceData.code}03`, name: `Qu·∫≠n 3`, type: 'Qu·∫≠n' },
      { code: `${provinceData.code}04`, name: `Huy·ªán 1`, type: 'Huy·ªán' },
      { code: `${provinceData.code}05`, name: `Huy·ªán 2`, type: 'Huy·ªán' }
    ]

    for (const districtData of districts) {
      const district = await prisma.district.upsert({
        where: { code: districtData.code },
        update: {},
        create: {
          ...districtData,
          provinceId: province.id
        }
      })

      // Create some wards for each district
      const wards = [
        { code: `${districtData.code}01`, name: `Ph∆∞·ªùng 1`, type: 'Ph∆∞·ªùng' },
        { code: `${districtData.code}02`, name: `Ph∆∞·ªùng 2`, type: 'Ph∆∞·ªùng' },
        { code: `${districtData.code}03`, name: `X√£ 1`, type: 'X√£' },
        { code: `${districtData.code}04`, name: `X√£ 2`, type: 'X√£' }
      ]

      for (const wardData of wards) {
        await prisma.ward.upsert({
          where: { code: wardData.code },
          update: {},
          create: {
            ...wardData,
            districtId: district.id
          }
        })
      }
    }
  }

  console.log('‚úÖ Vietnam addresses seeded')
}

async function seedProducts() {
  console.log('üé® Seeding products...')

  const products = [
    {
      name: 'KOVA Premium Interior',
      brand: 'KOVA',
      category: 'S∆°n N·ªôi Th·∫•t',
      description: 'S∆°n n·ªôi th·∫•t cao c·∫•p, ch·ªëng ·∫©m m·ªëc, d·ªÖ lau ch√πi',
      basePrice: 750000,
      originalPrice: 850000,
      coverageRate: 12.0,
      unit: 'th√πng 18L'
    },
    {
      name: 'KOVA Weathershield',
      brand: 'KOVA',
      category: 'S∆°n Ngo·∫°i Th·∫•t',
      description: 'S∆°n ngo·∫°i th·∫•t ch·ªëng th·∫•m, ch·ªëng n·∫Øng, b·ªÅn m√†u',
      basePrice: 850000,
      originalPrice: 950000,
      coverageRate: 10.0,
      unit: 'th√πng 18L'
    },
    {
      name: 'Jotun Lady Interior',
      brand: 'Jotun',
      category: 'S∆°n N·ªôi Th·∫•t',
      description: 'S∆°n n·ªôi th·∫•t th√¢n thi·ªán m√¥i tr∆∞·ªùng, kh√¥ng m√πi',
      basePrice: 1100000,
      originalPrice: 1200000,
      coverageRate: 11.0,
      unit: 'th√πng 18L'
    },
    {
      name: 'Jotun Weatherguard',
      brand: 'Jotun',
      category: 'S∆°n Ngo·∫°i Th·∫•t',
      description: 'S∆°n ngo·∫°i th·∫•t ch·ªëng th·∫•m cao c·∫•p, b·ªÅn m√†u l√¢u d√†i',
      basePrice: 1250000,
      originalPrice: 1350000,
      coverageRate: 9.0,
      unit: 'th√πng 18L'
    },
    {
      name: 'Dulux Easycare Interior',
      brand: 'Dulux',
      category: 'S∆°n N·ªôi Th·∫•t',
      description: 'S∆°n n·ªôi th·∫•t d·ªÖ lau ch√πi, ch·ªëng b√°m b·∫©n',
      basePrice: 880000,
      originalPrice: 980000,
      coverageRate: 12.5,
      unit: 'th√πng 18L'
    },
    {
      name: 'Dulux Weathershield Max',
      brand: 'Dulux',
      category: 'S∆°n Ngo·∫°i Th·∫•t',
      description: 'S∆°n ngo·∫°i th·∫•t ch·ªëng th·∫•m t·ªëi ƒëa, b·ªÅn m√†u',
      basePrice: 1050000,
      originalPrice: 1150000,
      coverageRate: 10.5,
      unit: 'th√πng 18L'
    },
    {
      name: 'Nippon Odour-less',
      brand: 'Nippon',
      category: 'S∆°n N·ªôi Th·∫•t',
      description: 'S∆°n n·ªôi th·∫•t kh√¥ng m√πi, th√¢n thi·ªán m√¥i tr∆∞·ªùng',
      basePrice: 1000000,
      originalPrice: 1100000,
      coverageRate: 11.5,
      unit: 'th√πng 18L'
    },
    {
      name: 'Nippon Weatherbond',
      brand: 'Nippon',
      category: 'S∆°n Ngo·∫°i Th·∫•t',
      description: 'S∆°n ngo·∫°i th·∫•t ch·ªëng th·∫•m, ch·ªëng n·∫Øng',
      basePrice: 1150000,
      originalPrice: 1250000,
      coverageRate: 10.0,
      unit: 'th√πng 18L'
    },
    {
      name: 'Maxilite Economy Interior',
      brand: 'Maxilite',
      category: 'S∆°n N·ªôi Th·∫•t',
      description: 'S∆°n n·ªôi th·∫•t gi√° r·∫ª, ch·∫•t l∆∞·ª£ng t·ªët',
      basePrice: 400000,
      originalPrice: 450000,
      coverageRate: 10.0,
      unit: 'th√πng 18L'
    },
    {
      name: 'Maxilite Weatherproof',
      brand: 'Maxilite',
      category: 'S∆°n Ngo·∫°i Th·∫•t',
      description: 'S∆°n ngo·∫°i th·∫•t ch·ªëng th·∫•m c∆° b·∫£n',
      basePrice: 500000,
      originalPrice: 550000,
      coverageRate: 9.0,
      unit: 'th√πng 18L'
    }
  ]

  for (const productData of products) {
    try {
      await prisma.product.upsert({
        where: { name: productData.name },
        update: {},
        create: productData
      })
    } catch (error) {
      console.log(`Skipping product ${productData.name}: ${error}`)
    }
  }

  console.log('‚úÖ Products seeded')
}

async function seedSuppliers() {
  console.log('üè¢ Seeding suppliers...')

  const suppliers = [
    {
      name: 'C√¥ng ty TNHH S∆°n KOVA',
      businessInfo: JSON.stringify({
        license: '0101234567',
        taxCode: '0101234567',
        website: 'https://kova.com.vn',
        description: 'Nh√† s·∫£n xu·∫•t s∆°n h√†ng ƒë·∫ßu Vi·ªát Nam v·ªõi h∆°n 30 nƒÉm kinh nghi·ªám'
      }),
      contactInfo: JSON.stringify({
        email: 'contact@kova.com.vn',
        phone: '02812345678',
        address: '123 ƒê∆∞·ªùng ABC, Qu·∫≠n 1, TP.HCM'
      }),
      isVerified: true
    },
    {
      name: 'C√¥ng ty CP S∆°n Jotun Vi·ªát Nam',
      businessInfo: JSON.stringify({
        license: '0102345678',
        taxCode: '0102345678',
        website: 'https://jotun.com.vn',
        description: 'Th∆∞∆°ng hi·ªáu s∆°n qu·ªëc t·∫ø uy t√≠n, chuy√™n s∆°n c√¥ng nghi·ªáp v√† d√¢n d·ª•ng'
      }),
      contactInfo: JSON.stringify({
        email: 'info@jotun.com.vn',
        phone: '02823456789',
        address: '456 ƒê∆∞·ªùng DEF, Qu·∫≠n 2, TP.HCM'
      }),
      isVerified: true
    },
    {
      name: 'C√¥ng ty TNHH S∆°n Dulux Vi·ªát Nam',
      businessInfo: JSON.stringify({
        license: '0103456789',
        taxCode: '0103456789',
        website: 'https://dulux.com.vn',
        description: 'Th∆∞∆°ng hi·ªáu s∆°n to√†n c·∫ßu, ƒëa d·∫°ng s·∫£n ph·∫©m cho m·ªçi nhu c·∫ßu'
      }),
      contactInfo: JSON.stringify({
        email: 'contact@dulux.com.vn',
        phone: '02834567890',
        address: '789 ƒê∆∞·ªùng GHI, Qu·∫≠n 3, TP.HCM'
      }),
      isVerified: true
    },
    {
      name: 'C√¥ng ty TNHH S∆°n Nippon Vi·ªát Nam',
      businessInfo: JSON.stringify({
        license: '0104567890',
        taxCode: '0104567890',
        website: 'https://nipponpaint.com.vn',
        description: 'S∆°n Nh·∫≠t B·∫£n ch·∫•t l∆∞·ª£ng cao, c√¥ng ngh·ªá ti√™n ti·∫øn'
      }),
      contactInfo: JSON.stringify({
        email: 'info@nipponpaint.com.vn',
        phone: '02845678901',
        address: '321 ƒê∆∞·ªùng JKL, Qu·∫≠n 1, TP.HCM'
      }),
      isVerified: true
    },
    {
      name: 'C√¥ng ty TNHH S∆°n Maxilite',
      businessInfo: JSON.stringify({
        license: '0105678901',
        taxCode: '0105678901',
        website: 'https://maxilite.com.vn',
        description: 'S∆°n gi√° r·∫ª, ch·∫•t l∆∞·ª£ng t·ªët cho th·ªã tr∆∞·ªùng ƒë·∫°i ch√∫ng'
      }),
      contactInfo: JSON.stringify({
        email: 'contact@maxilite.com.vn',
        phone: '02856789012',
        address: '654 ƒê∆∞·ªùng MNO, Qu·∫≠n 2, TP.HCM'
      }),
      isVerified: false
    }
  ]

  for (const supplierData of suppliers) {
    await prisma.supplier.upsert({
      where: { name: supplierData.name },
      update: {},
      create: supplierData
    })
  }

  console.log('‚úÖ Suppliers seeded')
}

async function seedUsers() {
  console.log('üë• Seeding users...')

  const users = [
    {
      email: 'admin@vncompare.com',
      name: 'Admin VNCompare',
      role: 'admin'
    },
    {
      email: 'customer1@example.com',
      name: 'Nguy·ªÖn VƒÉn A',
      role: 'customer'
    },
    {
      email: 'customer2@example.com',
      name: 'Tr·∫ßn Th·ªã B',
      role: 'customer'
    },
    {
      email: 'customer3@example.com',
      name: 'L√™ VƒÉn C',
      role: 'customer'
    },
    {
      email: 'customer4@example.com',
      name: 'Ph·∫°m Th·ªã D',
      role: 'customer'
    }
  ]

  for (const userData of users) {
    await prisma.user.upsert({
      where: { email: userData.email },
      update: {},
      create: userData
    })
  }

  console.log('‚úÖ Users seeded')
}

async function seedOrders() {
  console.log('üì¶ Seeding orders...')

  // Get some products and suppliers
  const products = await prisma.product.findMany({ take: 5 })
  const suppliers = await prisma.supplier.findMany({ take: 3 })
  const users = await prisma.user.findMany({ where: { role: 'customer' } })

  if (products.length === 0 || suppliers.length === 0 || users.length === 0) {
    console.log('‚ö†Ô∏è Skipping orders seeding - missing required data')
    return
  }

  const orders = [
    {
      userId: users[0].id,
      productId: products[0].id,
      supplierId: suppliers[0].id,
      quantity: 2,
      totalPrice: products[0].basePrice! * 2,
      shippingAddress: JSON.stringify({
        name: 'Nguy·ªÖn VƒÉn A',
        phone: '0901234567',
        address: '123 ƒê∆∞·ªùng ABC, Ph∆∞·ªùng 1, Qu·∫≠n 1, TP.HCM'
      }),
      status: 'completed'
    },
    {
      userId: users[1].id,
      productId: products[1].id,
      supplierId: suppliers[1].id,
      quantity: 1,
      totalPrice: products[1].basePrice! * 1,
      shippingAddress: JSON.stringify({
        name: 'Tr·∫ßn Th·ªã B',
        phone: '0901234568',
        address: '456 ƒê∆∞·ªùng DEF, Ph∆∞·ªùng 2, Qu·∫≠n 2, TP.HCM'
      }),
      status: 'pending'
    },
    {
      userId: users[2].id,
      productId: products[2].id,
      supplierId: suppliers[2].id,
      quantity: 3,
      totalPrice: products[2].basePrice! * 3,
      shippingAddress: JSON.stringify({
        name: 'L√™ VƒÉn C',
        phone: '0901234569',
        address: '789 ƒê∆∞·ªùng GHI, Ph∆∞·ªùng 3, Qu·∫≠n 3, TP.HCM'
      }),
      status: 'shipped'
    }
  ]

  for (const orderData of orders) {
    await prisma.order.create({
      data: orderData
    })
  }

  console.log('‚úÖ Orders seeded')
}

main()
  .catch((e) => {
    console.error('‚ùå Seeding failed:', e)
    process.exit(1)
  })
  .finally(async () => {
    await prisma.$disconnect()
  })
